# 键盘TCP位姿控制器

这是一个通过键盘控制机器人TCP位姿的Python程序，使用ROS2服务与机器人通信。

## 功能特性

- **实时键盘控制**：支持平移和旋转控制
- **增量运动模式**：基于当前位置的相对运动
- **可调步进值**：通过数字键快速调整运动精度
- **安全控制**：包含重置和退出功能

## 控制说明

### 平移控制（X、Y、Z轴）
- `w` / `s` : 前进/后退 (X轴正/负方向)
- `a` / `d` : 左移/右移 (Y轴正/负方向)  
- `Space` / `Shift` : 上升/下降 (Z轴正/负方向)

### 旋转控制（Rx、Ry、Rz）
- `q` / `e` : 绕Z轴旋转 (Rz 正/负方向)
- `↑` / `↓` : 绕Y轴旋转 (Ry 正/负方向)
- `←` / `→` : 绕X轴旋转 (Rx 正/负方向)

### 设置控制
- `1-9` : 设置步进值为 1-9 mm/度
- `0` : 设置步进值为 10 mm/度
- `r` : 重置到零位（相对于启动位置）
- `ESC` : 退出程序

## 使用方法

### 前提条件

1. 确保ROS2环境已正确配置
2. 确保机器人控制服务 `/robot_servo_line` 正在运行
3. 安装必要的Python依赖包

### 运行程序

```bash
# 方法1：直接运行Python脚本
cd /home/phoenix/roboarm/FairinoDualArm
source install/setup.bash
python3 src/tools/scripts/keyboard_ctrl.py

# 方法2：使用ROS2 run命令（需要先编译包）
ros2 run tools keyboard_ctrl.py
```

### 操作流程

1. 启动程序后，会显示控制说明
2. 程序会等待机器人服务可用
3. 首次按下运动键时，会自动启动伺服模式
4. 使用键盘控制机器人运动
5. 按ESC键安全退出程序

## 技术参数

- **默认步进值**：1.0 mm（平移）/ 1.0 度（旋转）
- **运动速度**：20%
- **加速度**：20%
- **指令周期**：8ms
- **运动模式**：增量运动（基坐标系）

## 安全注意事项

⚠️ **重要提醒**：
- 使用前确保机器人工作空间内无障碍物
- 运动过程中注意观察机器人状态
- 遇到异常情况立即按ESC退出
- 首次使用建议设置较小的步进值进行测试

## 故障排除

### 常见问题

1. **服务连接失败**
   - 检查机器人控制节点是否正在运行
   - 确认服务名称是否正确：`/robot_servo_line`

2. **键盘输入无响应**
   - 确保终端窗口处于焦点状态
   - 检查是否有其他程序占用标准输入

3. **运动不正确**
   - 检查坐标系设置是否正确
   - 确认步进值是否合适

### 调试信息

程序运行时会输出以下信息：
- 当前TCP位姿
- 伺服模式状态
- 步进值变更
- 错误信息

## 开发信息

- **语言**：Python 3
- **框架**：ROS2
- **依赖包**：rclpy, geometry_msgs, robo_ctrl
- **兼容性**：Linux系统，支持终端键盘输入

## 许可证

TODO: 添加许可证信息
